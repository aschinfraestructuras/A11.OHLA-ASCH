<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test - Portal de Calidad</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .log { margin: 5px 0; padding: 5px; border-left: 3px solid #ccc; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .info { border-left-color: #17a2b8; background: #d1ecf1; }
    </style>
</head>
<body>
    <h1>üêõ Debug Test - Portal de Calidad</h1>
    <div id="logs"></div>
    
    <button onclick="runTest()">Executar Teste</button>
    <button onclick="clearLogs()">Limpar Logs</button>

    <script>
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const logDiv = document.createElement('div');
            logDiv.className = `log ${type}`;
            logDiv.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logsDiv.appendChild(logDiv);
            console.log(message);
        }
        
        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }
        
        async function runTest() {
            clearLogs();
            log('üöÄ Iniciando teste de debug...', 'info');
            
            // Teste 1: Verificar CONFIG
            try {
                log('üìã Testando carregamento do CONFIG...', 'info');
                if (typeof CONFIG !== 'undefined') {
                    log(`‚úÖ CONFIG carregado - Auth: ${CONFIG.auth.enabled}`, 'success');
                } else {
                    log('‚ùå CONFIG n√£o carregado', 'error');
                    return;
                }
            } catch (error) {
                log(`‚ùå Erro ao carregar CONFIG: ${error.message}`, 'error');
                return;
            }
            
            // Teste 2: Verificar DatabaseManager
            try {
                log('üóÑÔ∏è Testando DatabaseManager...', 'info');
                if (typeof DatabaseManager !== 'undefined') {
                    log('‚úÖ DatabaseManager carregado', 'success');
                } else {
                    log('‚ùå DatabaseManager n√£o carregado', 'error');
                }
            } catch (error) {
                log(`‚ùå Erro DatabaseManager: ${error.message}`, 'error');
            }
            
            // Teste 3: Verificar PortalCalidad
            try {
                log('üèóÔ∏è Testando PortalCalidad...', 'info');
                if (typeof PortalCalidad !== 'undefined') {
                    log('‚úÖ PortalCalidad carregado', 'success');
                } else {
                    log('‚ùå PortalCalidad n√£o carregado', 'error');
                }
            } catch (error) {
                log(`‚ùå Erro PortalCalidad: ${error.message}`, 'error');
            }
            
            // Teste 4: Carregar manifest
            try {
                log('üìÑ Testando carregamento do manifest...', 'info');
                const response = await fetch('data/manifest.json');
                if (response.ok) {
                    const manifest = await response.json();
                    log(`‚úÖ Manifest carregado - ${manifest.secciones.length} se√ß√µes`, 'success');
                } else {
                    log(`‚ùå Erro HTTP: ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚ùå Erro ao carregar manifest: ${error.message}`, 'error');
            }
            
            // Teste 5: Verificar elementos HTML
            try {
                log('üîç Verificando elementos HTML...', 'info');
                const elements = ['chaptersList', 'searchInput', 'documentsContainer'];
                elements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        log(`‚úÖ Elemento ${id} encontrado`, 'success');
                    } else {
                        log(`‚ùå Elemento ${id} n√£o encontrado`, 'error');
                    }
                });
            } catch (error) {
                log(`‚ùå Erro ao verificar HTML: ${error.message}`, 'error');
            }
            
            log('üèÅ Teste conclu√≠do!', 'info');
        }
        
        // Executar teste automaticamente
        window.onload = function() {
            log('üì± P√°gina carregada', 'info');
            setTimeout(runTest, 1000);
        };
    </script>
    
    <!-- Carregar scripts -->
    <script src="config.js"></script>
    <script src="assets/database.js"></script>
    <script src="assets/document-viewer.js"></script>
    <script src="assets/app.js"></script>
</body>
</html>